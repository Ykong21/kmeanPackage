% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kr_boot.R
\name{kr_boot}
\alias{kr_boot}
\title{K-means kernel estimator with resampling
Implements a K-means based kernel estimation procedure with a resampling
scheme to obtain predictions at query points. The function follows the
original implementation, including tuning over lambda0 and the
weighted resampling step.}
\usage{
kr_boot(N, n, B, x, y, x0s, y0s, lambda0)
}
\arguments{
\item{N}{Integer. Number of rows in \code{x} (usually \code{nrow(x)}).}

\item{n}{Integer. Subsample size and number of k-means clusters.}

\item{B}{Integer. Number of bootstrap/resampling replicates.}

\item{x}{Numeric matrix/data.frame of size N x p. Training covariates.}

\item{y}{Numeric vector of length N. Training response.}

\item{x0s}{Numeric matrix of size m x p. Query points where to predict.}

\item{y0s}{Numeric vector of length m. True responses at \code{x0s} (for MSE reporting).}

\item{lambda0}{Numeric vector. Candidate lambda values for BIC tuning.}
}
\value{
A list with elements:
\describe{
\item{coeffi}{Last fitted coefficient vector \code{avec} (from the last resample).}
\item{y0s}{The provided \code{y0s}.}
\item{est}{m x 1 matrix of estimated mean predictions at \code{x0s}.}
\item{MSEKMean}{Vector of squared errors (y0s - est)^2.}
\item{Ave_MSE}{Mean squared error across x0s.}
\item{optimal_lam}{Selected lambda (scalar).}
\item{Converted_Time_Table}{Character vector of elapsed times for Total/Tuning/Est.}
\item{x0s}{The provided \code{x0s}.}
}
}
\description{
K-means kernel estimator with resampling
Implements a K-means based kernel estimation procedure with a resampling
scheme to obtain predictions at query points. The function follows the
original implementation, including tuning over lambda0 and the
weighted resampling step.
}
\examples{
set.seed(1)
N <- 200
p <- 3
x <- matrix(rnorm(N * p), N, p)
y <- x[, 1] - 2 * x[, 2] + rnorm(N)
x0s <- matrix(rnorm(10 * p), 10, p)
y0s <- x0s[, 1] - 2 * x0s[, 2]
out <- kr_boot(
  N = N, n = 20, B = 5,
  x = x, y = y,
  x0s = x0s, y0s = y0s,
  lambda0 = 10^seq(-2, 2, length.out = 10)
)
out$Ave_MSE

}
